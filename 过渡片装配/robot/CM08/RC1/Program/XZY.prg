1 '像素标定
2 '相机像素点转换为机器人坐标 走N个点  记录机器人位置   与像素点对应写入标定
3 '将一个点移动至视野中心     在视野范围内移动N个点  记录机器人当前位置 和像素点
4  m100=0
5 Wait m100=100
6 Tool P_01
7 Servo On
8 Wait M_Svo=1
9 Spd 100
10 P5=P_Fbc                                                                                          '十字中心点与视野中心点重合
11 Hlt                                                                                                       '保存中心点P1的机器人坐标
12 P1=P5*(-10.000,-10.000,+0.000,+0.000,+0.000,+0.000)
13 P2=P5*(+0.000,-10.000,+0.000,+0.000,+0.000,+0.000)
14 P3=P5*(+10.000,-10.000,+0.000,+0.000,+0.000,+0.000)
15 P4=P5*(-10.000,+0.000,+0.000,+0.000,+0.000,+0.000)
16 P6=P5*(+10.000,+0.000,+0.000,+0.000,+0.000,+0.000)
17 P7=P5*(-10.000,+10.000,+0.000,+0.000,+0.000,+0.000)
18 P8=P5*(+0.000,+10.000,+0.000,+0.000,+0.000,+0.000)
19 P9=P5*(+10.000,+10.000,+0.000,+0.000,+0.000,+0.000)
20 Mvs P1
21 Close
22 Open "COM3:" As #1
23 Dly 0.2
24 Print #1,"TRGS"
25 Input #1,M4,m5
26 M1=P1.X
27 M2=P1.Y
28 M3=0
29 Print #1,"XY",M1,M2
30 Input #1,M3
31 Wait M3=1
32 Hlt                                                                                             '读取机器人1号位置坐标，CCD像素坐标
33 Mvs P2
34 Dly 0.2
35 Print #1,"TRGS"
36 M1=P2.X
37 M2=P2.Y
38 Print #1,"XY",M1,M2
39 Input #1,M3
40 Wait M3=1
41 Hlt
42 Mvs P3
43 Dly 0.2
44 Print #1,"TRGS"
45 M1=P3.X
46 M2=P3.Y
47 Print #1,"XY",M1,M2
48 Input #1,M3
49 Wait M3=1
50 Hlt
51 Mvs P4
52 Dly 0.2
53 Print #1,"TRGS"
54 M1=P4.X
55 M2=P4.Y
56 Print #1,"XY",M1,M2
57 Input #1,M3
58 Wait M3=1
59 Hlt
60 Mvs P5
61 Dly 0.2
62 Print #1,"TRGS"
63 M1=P5.X
64 M2=P5.Y
65 Print #1,"XY",M1,M2
66 Input #1,M3
67 Wait M3=1
68 Hlt
69 Mvs P6
70 Dly 0.2
71 Print #1,"TRGS"
72 M1=P6.X
73 M2=P6.Y
74 Print #1,"XY",M1,M2
75 Input #1,M3
76 Wait M3=1
77 Hlt
78 Mvs P7
79 Dly 0.2
80 Print #1,"TRGS"
81 M1=P7.X
82 M2=P7.Y
83 Print #1,"XY",M1,M2
84 Input #1,M3
85 Wait M3=1
86 Hlt
87 Mvs P8
88 Dly 0.2
89 Print #1,"TRGS"
90 M1=P8.X
91 M2=P8.Y
92 Print #1,"XY",M1,M2
93 Input #1,M3
94 Wait M3=1
95 Close
96 Hlt
97 Mvs P9
98 Print #1,"TRGS"
99 M1=P9.X
100 M2=P9.Y
101 Print #1,"XY",M1,M2
102 Input #1,M3
103 Wait M3=1
104 Close
105 Hlt
P5=(+362.000,-139.503,+66.254,+0.000,+0.000,+79.909)(0,0)
P1=(+370.000,-151.111,+66.252,+0.000,+0.000,+79.881)(0,0)
P2=(+371.845,-141.255,+66.254,+0.000,+0.000,+79.909)(0,0)
P3=(+373.597,-131.410,+66.254,+0.000,+0.000,+79.909)(0,0)
P4=(+360.248,-149.348,+66.254,+0.000,+0.000,+79.909)(0,0)
P6=(+363.752,-129.658,+66.254,+0.000,+0.000,+79.909)(0,0)
P7=(+350.402,-147.596,+66.254,+0.000,+0.000,+79.909)(0,0)
P8=(+352.155,-137.751,+66.254,+0.000,+0.000,+79.909)(0,0)
P9=(+353.907,-127.905,+66.254,+0.000,+0.000,+79.909)(0,0)
