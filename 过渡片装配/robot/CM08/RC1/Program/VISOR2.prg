1 PPICK=P_30                 'PPICK上料位
2 PVSCHK=P_31               'PVSCHK拍照位
3 PPLACE=P_32                'PPLACE下料位
4 PH=P_33
5 PUT=P_Fbc
6 PUT.Z=90
7 Mov PUT
8 'Mov PHOME                 'PHOME等待位
9 Hlt
10 Mov PPICK, 40              'PPICK上料位
11 Mov PPICK
12 Dly 0.2
13 M_Out(16)=1
14 'Hlt
15 Mov PPICK, 40
16 Mov PVSCHK              'PVSCHK拍照位
17 Dly 0.2
18 Hlt
19 Close
20 Open "COM3:" As #2
21 Open "COM4:" As #3
22 Wait M_Open(2)=1
23 Wait M_Open(3)=1
24 Print #2, "ORG"
25 Dly 0.1
26 Input #3, Mx1, My1, Mc1
27 Mx=Mx1/1000
28 My=My1/1000
29 Mc=Mc1/10000
30 pvs1=P_Zero
31 pvs1=PVSCal(4, Mx, My, Mc)
32 pvs1.C=Rad(Mc)
33 pvs1.FL1=PVSCHK.FL1
34 pvs1.FL2=PVSCHK.FL2
35 '============原版
36 PHND=pvs1*PH
37 PPLACE1=Inv(PHND)*PVSCHK
38 PPLACE2=PPLACE1*PPLACE
39 '============
40 PD=Inv(pvs1)*pvs0
41 PP=PD*PPLACE
42 '============
43 Mov PPLACE2, 40
44 Mov PPLACE2,0.5
45 Hlt
46 M_Out(16)=0
47 Dly 0.1
48 Mov PPLACE2, 40
49 Hlt
50 End
PPICK=(-120.814,-290.839,+49.826,+0.000,+0.000,+162.780,+0.000,+0.000)(0,0)
PVSCHK=(+226.452,+46.649,+138.222,+0.000,+0.000,+152.534,+0.000,+0.000)(0,0)
PPLACE=(+410.673,-231.850,+56.000,+0.000,+0.000,+156.176)(0,0)
PH=(+1.569,-0.268,+138.222,+0.000,+0.000,+152.534,+0.000,+0.000)(0,0)
PUT=(+410.106,-231.172,+90.000,+0.000,+0.000,+156.176,+0.000,+0.000)(0,0)
pvs1=(+225.653,+46.616,+0.000,+0.000,+0.000,+0.000,+0.000,+0.000)(0,0)
PHND=(+227.222,+46.348,+138.222,+0.000,+0.000,+152.534,+0.000,+0.000)(0,0)
PPLACE1=(+0.822,+0.088,+0.000,+0.000,+0.000,+0.000,+0.000,+0.000)(0,0)
PPLACE2=(+411.495,-231.762,+56.000,+0.000,+0.000,+156.176,+0.000,+0.000)(0,0)
PD=(-0.770,+0.301,+0.000,+0.000,+0.000,+0.000,+0.000,+0.000)(0,0)
pvs0=(+224.883,+46.917,+0.000,+0.000,+0.000,+0.000,+0.000,+0.000)(0,0)
PP=(+409.903,-231.549,+56.000,+0.000,+0.000,+156.176,+0.000,+0.000)(0,0)
PD1=(+0.773,+0.142,+138.222,+0.000,+0.000,+152.534,+0.000,+0.000)(0,0)
